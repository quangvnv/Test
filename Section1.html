<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image-Based Multiple Choice Test</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 15px;
            font-size: 28px;
            border-bottom: 3px solid #2196F3;
            padding-bottom: 0px;
        }
        .section-container {
            margin-bottom: 30px;
        }
        .question-item {
            display: grid;
            grid-template-columns: 50% 50%;
            gap: 30px;
            margin-bottom: 30px;
            padding: 25px;
            background: #fafafa;
            border-radius: 8px;
            border-left: 4px solid #2196F3;
        }
        .question-image {
            display: flex;
            align-items: center;
            justify-content: center;
            background: #fff;
            padding: 20px;
            border-radius: 6px;
            border: 2px solid #e0e0e0;
            min-height: 200px;
        }
        .question-image img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            border-radius: 4px;
        }
        .question-image .placeholder {
            color: #999;
            text-align: center;
            padding: 60px 20px;
        }
        .question-number {
            font-weight: 700;
            color: #1976D2;
            margin-bottom: 15px;
            font-size: 18px;
        }
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .option-item {
            display: flex;
            align-items: flex-start;
            padding: 12px 15px;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .option-item:hover {
            border-color: #2196F3;
            background: #f5f9ff;
        }
        .option-item.selected {
            border-color: #2196F3;
            background: #e3f2fd;
        }
        .option-item.correct {
            border-color: #4CAF50;
            background: #c8e6c9;
        }
        .option-item.incorrect {
            border-color: #f44336;
            background: #ffcdd2;
        }
        .option-item input[type="radio"] {
            margin-right: 12px;
            margin-top: 3px;
            cursor: pointer;
        }
        .option-label {
            flex: 1;
            cursor: pointer;
            font-size: 15px;
            line-height: 1.5;
        }
        .button-container {
            margin-top: 30px;
            text-align: center;
        }
        .submit-btn {
            padding: 18px 60px;
            background: #2196F3;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
        }
        .submit-btn:hover {
            background: #1976D2;
        }
        .submit-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .result {
            margin-top: 25px;
            padding: 25px;
            background: #e8f5e9;
            border-radius: 6px;
            text-align: center;
            font-size: 20px;
            font-weight: 600;
            display: none;
            border: 2px solid #4CAF50;
        }
        .result.show {
            display: block;
        }
        .result .score {
            font-size: 32px;
            color: #4CAF50;
            margin: 10px 0;
        }
        .retry-btn {
            display: none;
            padding: 18px 60px;
            background: #FF9800;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 15px;
        }
        .retry-btn:hover {
            background: #F57C00;
        }
        .retry-btn.show {
            display: inline-block;
        }
        @media (max-width: 768px) {
            .question-item {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìù Section 1: Choose the best answer for each note, message or email</h1>
        
        <div id="sectionsContainer"></div>
        
        <div class="button-container">
            <button class="submit-btn" id="submitBtn">N·ªôp b√†i</button>
            <div class="result" id="result"></div>
            <button class="retry-btn" id="retryBtn">L√†m l·∫°i</button>
        </div>
    </div>

    <script>
        const section = {
            "id": "section1",
            "title": "SECTION 1: Choose the best answer for each note, message or email.",
            "questions": [
                {
                    "image": "images/section1-q1.png",
                    "options": [
                        "Jasmin wants Sarah to buy some milk.",
                        "Jasmin says she will go shopping later.",
                        "Jasmin wants Sarah to go to the supermarket."
                    ],
                    "answer": 0
                },
                {
                    "image": "images/section1-q2.png",
                    "options": [
                        "On Fridays no one is at the information desk.",
                        "Computer centre staff can help students on Friday afternoons.",
                        "The computer centre helpdesk is only open on Fridays."
                    ],
                    "answer": 2
                },
                {
                    "image": "images/section1-q3.png",
                    "options": [
                        "Wednesday is not a good time for Brad to meet.",
                        "Brad wants Jenny to book him an appointment with the dentist.",
                        "Brad needs to meet Jenny at a different time."
                    ],
                    "answer": 2
                },
                {
                    "image": "images/section1-q4.png",
                    "options": [
                        "Customers can save a lot on writing products.",
                        "There are many different types of cookbooks on sale.",
                        "Books for school tests are two for the price of one."
                    ],
                    "answer": 0
                },
                {
                    "image": "images/section1-q5.png",
                    "options": [
                        "Richard wants Sami to come to the cinema with him today.",
                        "Richard is going to buy cinema tickets at the weekend.",
                        "Sami should decide if he wants to go to the cinema today."
                    ],
                    "answer": 1
                }
            ]
        };

        let userAnswers = {};

        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function renderSection() {
            userAnswers = {};
            
            const container = document.getElementById('sectionsContainer');
            
            const shuffledQuestionsData = section.questions.map(q => {
                const optionsWithIndices = q.options.map((opt, idx) => ({
                    text: opt,
                    originalIndex: idx
                }));
                return shuffleArray(optionsWithIndices);
            });
            
            container.innerHTML = `
                <div class="section-container">
                    ${section.questions.map((q, qIdx) => {
                        const shuffledOptions = shuffledQuestionsData[qIdx];
                        return `
                        <div class="question-item">
                            <div class="question-image">
                                ${q.image ? 
                                    `<img src="${q.image}" alt="Question ${qIdx + 1}">` : 
                                    `<div class="placeholder">üì∑<br>Image for Question ${qIdx + 1}</div>`
                                }
                            </div>
                            <div>
                                <div class="question-number">Question ${qIdx + 1}</div>
                                <div class="options-container">
                                    ${shuffledOptions.map((opt, displayIdx) => `
                                        <label class="option-item" id="option-${qIdx}-${opt.originalIndex}">
                                            <input type="radio" 
                                                   name="q-${qIdx}" 
                                                   value="${opt.originalIndex}"
                                                   onchange="handleAnswer(${qIdx}, ${opt.originalIndex})">
                                            <span class="option-label">${String.fromCharCode(65 + displayIdx)}. ${opt.text}</span>
                                        </label>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                    `}).join('')}
                </div>
            `;
            
            document.getElementById('submitBtn').style.display = 'inline-block';
            document.getElementById('result').classList.remove('show');
            document.getElementById('retryBtn').classList.remove('show');
        }

        function handleAnswer(questionIdx, optionIdx) {
            userAnswers[questionIdx] = optionIdx;
            
            section.questions[questionIdx].options.forEach((_, idx) => {
                const optionElem = document.getElementById(`option-${questionIdx}-${idx}`);
                if (optionElem) {
                    optionElem.classList.toggle('selected', idx === optionIdx);
                }
            });
        }

        document.getElementById('submitBtn').addEventListener('click', () => {
            const totalQuestions = section.questions.length;
            
            let answeredCount = Object.keys(userAnswers).length;
            
            if (answeredCount < totalQuestions) {
                alert('Vui l√≤ng tr·∫£ l·ªùi t·∫•t c·∫£ c√°c c√¢u h·ªèi!');
                return;
            }

            let score = 0;
            
            section.questions.forEach((q, qIdx) => {
                const userAns = userAnswers[qIdx];
                const isCorrect = userAns === q.answer;
                
                if (isCorrect) score++;

                q.options.forEach((_, optIdx) => {
                    const optionElem = document.getElementById(`option-${qIdx}-${optIdx}`);
                    const radioInput = optionElem ? optionElem.querySelector('input[type="radio"]') : null;
                    
                    if (optionElem && radioInput) {
                        radioInput.disabled = true;
                        optionElem.style.cursor = 'not-allowed';
                        
                        if (optIdx === q.answer) {
                            optionElem.classList.add('correct');
                            optionElem.classList.remove('selected', 'incorrect');
                        } else if (optIdx === userAns && !isCorrect) {
                            optionElem.classList.add('incorrect');
                            optionElem.classList.remove('selected', 'correct');
                        } else {
                            optionElem.classList.remove('selected');
                        }
                    }
                });
            });

            const percentage = Math.round((score / totalQuestions) * 100);
            const resultDiv = document.getElementById('result');
            
            let emoji = 'üéâ';
            let message = 'Xu·∫•t s·∫Øc!';
            if (percentage < 50) {
                emoji = 'üìö';
                message = 'C·ªë g·∫Øng l√™n!';
            } else if (percentage < 80) {
                emoji = 'üëç';
                message = 'Kh√° t·ªët!';
            }
            
            resultDiv.innerHTML = `
                <div>${emoji} ${message}</div>
                <div class="score">${score}/${totalQuestions}</div>
                <div>ƒêi·ªÉm s·ªë: ${percentage}%</div>
            `;
            resultDiv.classList.add('show');
            document.getElementById('submitBtn').style.display = 'none';
            document.getElementById('retryBtn').classList.add('show');
        });

        document.getElementById('retryBtn').addEventListener('click', () => {
            renderSection();
        });

        window.addEventListener('load', renderSection);
    </script>
</body>
</html>